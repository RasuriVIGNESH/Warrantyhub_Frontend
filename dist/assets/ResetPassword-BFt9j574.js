import{r as n,a as P,k as S,j as e,L as d,i}from"./index-DoWs054Z.js";import{u as R}from"./index.esm-DwDJNE48.js";import{u as q}from"./useAuth-DxPVRwz5.js";import{L as m}from"./lock-t4GtfEtb.js";import{E as x,a as p}from"./eye-D8B5fptY.js";function A(){const[r,u]=n.useState(!1),[t,h]=n.useState(!1),[w,y]=n.useState(!1);P();const[f]=S(),a=f.get("token"),{resetPassword:g}=q(),{register:l,handleSubmit:b,watch:j,formState:{errors:s,isSubmitting:c}}=R({defaultValues:{password:"",confirmPassword:""}}),N=j("password"),v=async o=>{if(!a){i.error("Invalid reset link. Please request a new password reset.");return}try{await g(a,o.password)&&(y(!0),i.success("Password reset successfully!"))}catch{i.error("Failed to reset password. Please try again.")}};return a?w?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Password Reset Successful"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Your password has been reset successfully. You can now sign in with your new password."})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(d,{to:"/login",className:"font-medium text-primary hover:text-primary-dark",children:"Sign in"})})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Reset your password"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"Enter your new password below."})]}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:b(v),children:[e.jsxs("div",{className:"rounded-md shadow-sm space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(m,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"password",type:r?"text":"password",...l("password",{required:"Password is required",minLength:{value:8,message:"Password must be at least 8 characters"},pattern:{value:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,message:"Password must contain at least one uppercase letter, one lowercase letter, one number and one special character"}}),className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white bg-white dark:bg-gray-700 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm",placeholder:"New password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>u(!r),children:r?e.jsx(x,{className:"h-5 w-5 text-gray-400"}):e.jsx(p,{className:"h-5 w-5 text-gray-400"})})]}),s.password&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.password.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"sr-only",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(m,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{id:"confirmPassword",type:t?"text":"password",...l("confirmPassword",{required:"Please confirm your password",validate:o=>o===N||"The passwords do not match"}),className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-2 border border-gray-300 dark:border-gray-600 placeholder-gray-500 dark:placeholder-gray-400 text-gray-900 dark:text-white bg-white dark:bg-gray-700 focus:outline-none focus:ring-primary focus:border-primary focus:z-10 sm:text-sm",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>h(!t),children:t?e.jsx(x,{className:"h-5 w-5 text-gray-400"}):e.jsx(p,{className:"h-5 w-5 text-gray-400"})})]}),s.confirmPassword&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.confirmPassword.message})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-primary hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):"Reset Password"})}),e.jsx("div",{className:"text-center",children:e.jsx(d,{to:"/login",className:"font-medium text-primary hover:text-primary-dark",children:"Back to login"})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900 dark:text-white",children:"Invalid Reset Link"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600 dark:text-gray-400",children:"The password reset link is invalid or has expired. Please request a new password reset."})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx(d,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary-dark",children:"Request new reset link"})})]})})}export{A as ResetPassword};
